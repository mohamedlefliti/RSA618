import numpy as np
import matplotlib.pyplot as plt
import random
from decimal import Decimal, getcontext

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¯Ù‚Ø© Ø§Ù„Ø¹Ø´Ø±ÙŠØ© (Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø§Ù†Ø§Øª)
getcontext().prec = 1000  # ÙƒØ§ÙÙŠØ© Ù„ØªÙ…Ø«ÙŠÙ„ Ø£Ø¹Ø¯Ø§Ø¯ Ø¶Ø®Ù…Ø© Ø¬Ø¯Ù‹Ø§

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø²Ù…Ù† ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
t = np.linspace(0, 1, 1000)
alpha = 0.6
beta = 0.4

# Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙˆØ¬Ø§Øª ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Decimal
def factor_wave(guess):
    freq = Decimal(guess).ln()  # log Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Decimal
    freq_f = float(freq)  # ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ float ÙÙ‚Ø· Ø¨Ø¹Ø¯ log
    amp = 1.0
    phase = 0
    wave = amp * np.sin(2 * np.pi * freq_f * t + phase)
    noise = np.random.normal(0, 0.1, size=t.shape)
    return wave + noise

def wave_xor(a, b):
    return np.abs(a - b)

def enhance(signal):
    return alpha * signal + beta * np.abs(signal)

def stability_score(signal):
    return 1 / (1 + np.std(np.gradient(signal)))

# ğŸ” ØªÙˆÙ„ÙŠØ¯ Ø¹Ø¯Ø¯ÙŠÙ† Ø¶Ø®Ù…ÙŠÙ† (ÙƒÙ„ Ù…Ù†Ù‡Ù…Ø§ â‰ˆ 309 Ø±Ù‚Ù…Ù‹Ø§ Ø¹Ø´Ø±ÙŠÙ‹Ø§)
p = random.randint(10**308, 10**309)
q = random.randint(10**308, 10**309)
N = p * q
print(f"ğŸ” Simulated RSA-like Number (N): {N}")
print(f"ğŸ”¢ Digits in N: {len(str(N))}")

# ğŸ§ª ØªÙˆÙ„ÙŠØ¯ ØªØ®Ù…ÙŠÙ†Ø§Øª ØªØ´Ù…Ù„ Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†
guesses = [p, q] + [random.randint(10**150, 10**151) for _ in range(98)]

# Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ±Ø§ÙƒØ¨ Ø§Ù„Ù…ÙˆØ¬ÙŠ
scores = []
signals = []

for g in guesses:
    if N % g != 0:
        continue
    pair = N // g
    try:
        w1 = factor_wave(g)
        w2 = factor_wave(pair)
        combined = wave_xor(w1, w2)
        enhanced = enhance(combined)
        score = stability_score(enhanced)
        scores.append((g, pair, score))
        signals.append((g, pair, enhanced))
    except Exception as e:
        print(f"âš ï¸ Error at guess {g}: {e}")
        continue

# Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
if scores:
    best = max(scores, key=lambda x: x[2])
    print(f"\nğŸ”“ Best Factorization Found: {best[0]} Ã— {best[1]} = {N}")
    print(f"ğŸ“ˆ Stability Score: {best[2]:.6f}")

    for g, p, sig in signals:
        if (g, p) == (best[0], best[1]) or (p, g) == (best[0], best[1]):
            plt.figure(figsize=(10, 4))
            plt.plot(t, sig, label=f'{g} Ã— {p}', color='purple')
            plt.title(f'Enhanced Signal for Factors of N')
            plt.xlabel('Time')
            plt.ylabel('Amplitude')
            plt.grid(True)
            plt.legend()
            plt.tight_layout()
            plt.show()
            break
else:
    print("ğŸš« No valid factors found in simulated range.")
